{% extends "base.html" %}

{% block title %}Cadastros{% endblock %}

{% block content %}
<h1 class="mb-4 text-primary"><i class="fas fa-plus-circle me-2"></i>Gerenciar Cadastros</h1>

<div class="accordion" id="cadastroAccordion">
    {% if user_level in ["admin", "cadastrador_pecas"] %}
    <div class="card mb-3 shadow-sm">
        <div class="card-header" id="headingPeca">
            <h2 class="mb-0">
                <button class="btn btn-link btn-block text-start text-decoration-none w-100 py-3" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePeca" aria-expanded="true" aria-controls="collapsePeca">
                    <i class="fas fa-tools me-2"></i>Cadastrar Peça
                </button>
            </h2>
        </div>
        <div id="collapsePeca" class="collapse show" aria-labelledby="headingPeca" data-bs-parent="#cadastroAccordion">
            <div class="card-body">
                <form method="POST" action="{{ url_for('cadastros') }}">
                    <input type="hidden" name="form_type" value="peca">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <label for="id_peca" class="form-label">Código da Peça</label>
                            <input type="text" class="form-control" id="id_peca" name="id_peca" required>
                        </div>
                        <div class="col-md-5">
                            <label for="nome_peca" class="form-label">Nome da Peça</label>
                            <input type="text" class="form-control" id="nome_peca" name="nome_peca" required>
                        </div>
                        <div class="col-md-2">
                            <label for="preco_peca" class="form-label">Preço (R$)</label>
                            <input type="number" class="form-control" id="preco_peca" name="preco_peca" step="0.01" min="0" required>
                        </div>
                        <div class="col-md-2">
                            <label for="pontuacao_peca" class="form-label">Pontuação</label>
                            <input type="number" class="form-control" id="pontuacao_peca" name="pontuacao_peca" min="0" required>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary mt-3"><i class="fas fa-save me-2"></i>Cadastrar Peça</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
    
    {% if user_level in ["admin", "rh"] %}
    <div class="card mb-3 shadow-sm">
        <div class="card-header" id="headingServico">
            <h2 class="mb-0">
                <button class="btn btn-link btn-block text-start text-decoration-none w-100 collapsed py-3" type="button" data-bs-toggle="collapse" data-bs-target="#collapseServico" aria-expanded="false" aria-controls="collapseServico">
                    <i class="fas fa-cogs me-2"></i>Cadastrar Serviço
                </button>
            </h2>
        </div>
        <div id="collapseServico" class="collapse" aria-labelledby="headingServico" data-bs-parent="#cadastroAccordion">
            <div class="card-body">
                <form method="POST" action="{{ url_for('cadastros') }}">
                    <input type="hidden" name="form_type" value="servico">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <label for="id_servico" class="form-label">Código do Serviço</label>
                            <input type="text" class="form-control" id="id_servico" name="id_servico" required>
                        </div>
                        <div class="col-md-6">
                            <label for="nome_servico" class="form-label">Nome do Serviço</label>
                            <input type="text" class="form-control" id="nome_servico" name="nome_servico" required>
                        </div>
                        <div class="col-md-3">
                            <label for="preco_servico" class="form-label">Preço (R$)</label>
                            <input type="number" class="form-control" id="preco_servico" name="preco_servico" step="0.01" min="0" required>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary mt-3"><i class="fas fa-save me-2"></i>Cadastrar Serviço</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="card mb-3 shadow-sm">
        <div class="card-header" id="headingCliente">
            <h2 class="mb-0">
                <button class="btn btn-link btn-block text-start text-decoration-none w-100 collapsed py-3" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCliente" aria-expanded="false" aria-controls="collapseCliente">
                    <i class="fas fa-user-plus me-2"></i>Cadastrar Cliente
                </button>
            </h2>
        </div>
        <div id="collapseCliente" class="collapse" aria-labelledby="headingCliente" data-bs-parent="#cadastroAccordion">
            <div class="card-body">
                <form method="POST" action="{{ url_for('cadastros') }}">
                    <input type="hidden" name="form_type" value="cliente">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="cpf_cliente" class="form-label">CPF</label>
                            <input type="text" class="form-control" id="cpf_cliente" name="cpf_cliente" required>
                        </div>
                        <div class="col-md-4">
                            <label for="nome_cliente" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="nome_cliente" name="nome_cliente" required>
                        </div>
                        <div class="col-md-4">
                            <label for="email_cliente" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email_cliente" name="email_cliente" required>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary mt-3"><i class="fas fa-save me-2"></i>Cadastrar Cliente</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="card mb-3 shadow-sm">
        <div class="card-header" id="headingVeiculo">
            <h2 class="mb-0">
                <button class="btn btn-link btn-block text-start text-decoration-none w-100 collapsed py-3" type="button" data-bs-toggle="collapse" data-bs-target="#collapseVeiculo" aria-expanded="false" aria-controls="collapseVeiculo">
                    <i class="fas fa-car me-2"></i>Cadastrar Veículo
                </button>
            </h2>
        </div>
        <div id="collapseVeiculo" class="collapse" aria-labelledby="headingVeiculo" data-bs-parent="#cadastroAccordion">
            <div class="card-body">
                <form method="POST" action="{{ url_for('cadastros') }}">
                    <input type="hidden" name="form_type" value="veiculo">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="placa_veiculo" class="form-label">Placa</label>
                            <input type="text" class="form-control" id="placa_veiculo" name="placa_veiculo" required>
                        </div>
                        <div class="col-md-5">
                            <label for="modelo_veiculo" class="form-label">Modelo</label>
                            <input type="text" class="form-control" id="modelo_veiculo" name="modelo_veiculo" required>
                        </div>
                        <div class="col-md-3">
                            <label for="ano_veiculo" class="form-label">Ano</label>
                            <input type="number" class="form-control" id="ano_veiculo" name="ano_veiculo" min="1900" max="{{ now().year + 1 }}" required>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary mt-3"><i class="fas fa-save me-2"></i>Cadastrar Veículo</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
</div>

{% if clientes %}
<h2 class="mt-5 mb-3 text-primary">Clientes Cadastrados</h2>
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-primary">
            <tr>
                <th>CPF</th>
                <th>Nome</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            {% for cliente in clientes %}
            <tr>
                <td>{{ cliente.cpf }}</td>
                <td>{{ cliente.nome }}</td>
                <td>{{ cliente.email }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

{% if veiculos %}
<h2 class="mt-5 mb-3 text-primary">Veículos Cadastrados</h2>
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-primary">
            <tr>
                <th>Placa</th>
                <th>Modelo</th>
                <th>Ano</th>
            </tr>
        </thead>
        <tbody>
            {% for veiculo in veiculos %}
            <tr>
                <td>{{ veiculo.placa }}</td>
                <td>{{ veiculo.modelo }}</td>
                <td>{{ veiculo.ano }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
